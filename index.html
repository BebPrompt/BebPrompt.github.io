<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Audio Library</title>
    <style>
        :root {
            --primary-color: #6200ea;
            --secondary-color: #9d46ff;
            --bg-color: #f5f5f5;
            --card-bg: #ffffff;
            --text-color: #333333;
            --sidebar-bg: #f0f0f0;
            --sidebar-hover: #e0e0e0;
            --sidebar-active: #d0d0ff;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            min-height: 100vh;
        }

        .sidebar {
            width: 280px;
            background-color: var(--sidebar-bg);
            height: 100vh;
            overflow-y: auto;
            position: fixed;
            top: 0;
            left: 0;
            box-shadow: 2px 0 5px rgba(0,0,0,0.1);
            z-index: 100;
        }

        .sidebar-header {
            padding: 20px;
            background-color: var(--primary-color);
            color: white;
            text-align: center;
        }

        .sidebar h2 {
            margin: 0;
            font-size: 1.5rem;
        }

        .sidebar-content {
            padding: 15px;
        }

        .sidebar .category {
            margin-bottom: 15px;
        }

        .sidebar .category-title {
            font-weight: bold;
            cursor: pointer;
            padding: 8px 5px;
            border-radius: 4px;
            transition: background-color 0.2s;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .sidebar .category-title:hover {
            background-color: var(--sidebar-hover);
        }

        .sidebar .category-content {
            margin-left: 15px;
            display: none;
        }

        .sidebar .category-content.active {
            display: block;
        }

        .sidebar .item {
            padding: 8px 5px;
            margin: 5px 0;
            cursor: pointer;
            border-radius: 4px;
            transition: background-color 0.2s;
        }

        .sidebar .item:hover {
            background-color: var(--sidebar-hover);
        }

        .sidebar .item.active {
            background-color: var(--sidebar-active);
        }

        .main-content {
            margin-left: 280px;
            padding: 20px;
            flex-grow: 1;
        }

        .audio-card {
            background-color: var(--card-bg);
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 20px;
            margin-bottom: 20px;
        }

        .audio-title {
            font-size: 1.5rem;
            margin-top: 0;
            margin-bottom: 15px;
            color: var(--primary-color);
        }

        .audio-description {
            margin-bottom: 20px;
            white-space: pre-line;
            line-height: 1.5;
        }

        audio {
            width: 100%;
            margin-bottom: 10px;
        }

        .audio-controls {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 15px;
        }

        .audio-controls button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 4px;
            padding: 8px 15px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .audio-controls button:hover {
            background-color: var(--secondary-color);
        }

        .breadcrumb {
            margin-bottom: 20px;
            padding: 10px;
            background-color: var(--card-bg);
            border-radius: 4px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .breadcrumb a {
            color: var(--primary-color);
            text-decoration: none;
        }

        .breadcrumb a:hover {
            text-decoration: underline;
        }

        .breadcrumb span {
            margin: 0 5px;
        }

        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                height: auto;
                position: relative;
                max-height: 50vh;
            }
            .main-content {
                margin-left: 0;
            }
        }
    </style>
</head>
<body>
    <div class="sidebar">
        <div class="sidebar-header">
            <h2>Audio Library</h2>
        </div>
        <div class="sidebar-content" id="artistList">
            <!-- Artists and categories will be populated here -->
        </div>
    </div>
    
    <div class="main-content">
        <div class="breadcrumb" id="breadcrumb">
            Home
        </div>
        <div id="audioContainer">
            <h1>Welcome to the Audio Library</h1>
            <p>Select an artist and category from the sidebar to browse audio files.</p>
        </div>
    </div>

    <script>
        // Structure to store our data
        const library = {};
        let currentArtist = '';
        let currentCategory = '';
        let currentFile = '';

        // Function to scan the directory structure
        async function scanLibrary() {
            try {
                // Fetch list of artists
                const artistsResponse = await fetch('');
                const artistsData = await artistsResponse.json();
                
                // For now, we're hard-coding Penelope as the artist since that's what we see
                const artists = ['Penelope'];
                
                for (const artist of artists) {
                    library[artist] = {};
                    
                    // Fetch categories for each artist
                    const categoriesResponse = await fetch(`${artist}/`);
                    const categoriesData = await categoriesResponse.text();
                    
                    // For Penelope, we know the categories from our directory exploration
                    const categories = ['Original', 'Therapy', 'Dominatrix', 'Teacher', 'Loops', 'Fills'];
                    
                    for (const category of categories) {
                        library[artist][category] = [];
                        
                        // Fetch files in each category
                        const filesResponse = await fetch(`${artist}/${category}/`);
                        const filesHtml = await filesResponse.text();
                        
                        // Since we can't directly list files this way with GitHub Pages,
                        // we'll load them dynamically when a category is selected
                    }
                }
                
                renderSidebar();
            } catch (error) {
                console.error('Error scanning library:', error);
                // If fetch fails, we'll use a more direct approach
                loadHardcodedStructure();
            }
        }

        // Function to load a hardcoded structure since we can't scan directories with client-side JS
        function loadHardcodedStructure() {
            library['Penelope'] = {
                'Original': [],
                'Therapy': [],
                'Dominatrix': [],
                'Teacher': [],
                'Loops': [],
                'Fills': []
            };
            
            renderSidebar();
        }

        // Function to render the sidebar
        function renderSidebar() {
            const artistList = document.getElementById('artistList');
            artistList.innerHTML = '';
            
            for (const artist in library) {
                const artistDiv = document.createElement('div');
                artistDiv.className = 'category';
                
                const artistTitle = document.createElement('div');
                artistTitle.className = 'category-title';
                artistTitle.innerHTML = `
                    <span>${artist}</span>
                    <span>▶</span>
                `;
                artistTitle.addEventListener('click', () => {
                    const content = artistDiv.querySelector('.category-content');
                    content.classList.toggle('active');
                    artistTitle.querySelector('span:last-child').textContent = 
                        content.classList.contains('active') ? '▼' : '▶';
                });
                
                const artistContent = document.createElement('div');
                artistContent.className = 'category-content';
                
                for (const category in library[artist]) {
                    const categoryItem = document.createElement('div');
                    categoryItem.className = 'item';
                    categoryItem.textContent = category;
                    categoryItem.addEventListener('click', () => {
                        // Remove active class from all items
                        document.querySelectorAll('.sidebar .item').forEach(item => {
                            item.classList.remove('active');
                        });
                        
                        // Add active class to clicked item
                        categoryItem.classList.add('active');
                        
                        // Load audio files for this category
                        loadCategory(artist, category);
                    });
                    
                    artistContent.appendChild(categoryItem);
                }
                
                artistDiv.appendChild(artistTitle);
                artistDiv.appendChild(artistContent);
                artistList.appendChild(artistDiv);
            }
        }

        // Function to load all audio files in a category
        async function loadCategory(artist, category) {
            currentArtist = artist;
            currentCategory = category;
            updateBreadcrumb();
            
            const audioContainer = document.getElementById('audioContainer');
            audioContainer.innerHTML = `<h1>${artist} - ${category}</h1><div id="audio-list"></div>`;
            const audioList = document.getElementById('audio-list');
            
            try {
                // In a real environment, we would fetch the directory listing
                // Since we can't do that with GitHub Pages, we'll manually load the files
                const fileList = await fetchFilesForCategory(artist, category);
                
                // Group files by base name (without extension)
                const fileGroups = {};
                
                fileList.forEach(file => {
                    const baseName = file.name.substring(0, file.name.lastIndexOf('.'));
                    if (!fileGroups[baseName]) {
                        fileGroups[baseName] = {
                            audio: null,
                            description: null
                        };
                    }
                    
                    if (file.name.endsWith('.mp3')) {
                        fileGroups[baseName].audio = file.path;
                    } else if (file.name.endsWith('.txt')) {
                        fileGroups[baseName].description = file.path;
                    }
                });
                
                // Create a card for each audio file with its description
                for (const baseName in fileGroups) {
                    const group = fileGroups[baseName];
                    
                    if (group.audio && group.description) {
                        // Fetch the description text
                        const descResponse = await fetch(group.description);
                        const descText = await descResponse.text();
                        
                        // Create an audio card
                        const card = document.createElement('div');
                        card.className = 'audio-card';
                        card.innerHTML = `
                            <h2 class="audio-title">${baseName.replace(/_/g, ' ')}</h2>
                            <div class="audio-description">${descText}</div>
                            <audio controls src="${group.audio}"></audio>
                            <div class="audio-controls">
                                <button class="download-btn" data-src="${group.audio}">Download</button>
                            </div>
                        `;
                        
                        // Add download functionality
                        const downloadBtn = card.querySelector('.download-btn');
                        downloadBtn.addEventListener('click', () => {
                            const link = document.createElement('a');
                            link.href = downloadBtn.dataset.src;
                            link.download = baseName + '.mp3';
                            document.body.appendChild(link);
                            link.click();
                            document.body.removeChild(link);
                        });
                        
                        audioList.appendChild(card);
                    }
                }
                
                if (audioList.children.length === 0) {
                    audioList.innerHTML = '<p>No audio files found in this category.</p>';
                }
                
            } catch (error) {
                console.error(`Error loading ${artist}/${category}:`, error);
                audioContainer.innerHTML = `
                    <h1>${artist} - ${category}</h1>
                    <p>Error loading audio files. Please try again later.</p>
                `;
            }
        }

        // Function to fetch files for a category
        async function fetchFilesForCategory(artist, category) {
            // In a real environment, we would fetch this from an API
            // For GitHub Pages, we'll use a simulated API call
            
            try {
                const response = await fetch(`https://api.github.com/repos/BebPrompt/BebPrompt.github.io/contents/${artist}/${category}`);
                if (!response.ok) {
                    throw new Error('Failed to fetch directory contents');
                }
                const data = await response.json();
                
                return data.map(item => ({
                    name: item.name,
                    path: item.download_url
                }));
            } catch (error) {
                console.error('Error fetching files:', error);
                return [];
            }
        }

        // Function to update breadcrumb
        function updateBreadcrumb() {
            const breadcrumb = document.getElementById('breadcrumb');
            let html = '<a href="#" onclick="navigateHome(); return false;">Home</a>';
            
            if (currentArtist) {
                html += ` <span>›</span> <a href="#" onclick="navigateArtist('${currentArtist}'); return false;">${currentArtist}</a>`;
            }
            
            if (currentCategory) {
                html += ` <span>›</span> ${currentCategory}`;
            }
            
            breadcrumb.innerHTML = html;
        }

        // Navigation functions
        function navigateHome() {
            currentArtist = '';
            currentCategory = '';
            updateBreadcrumb();
            
            document.getElementById('audioContainer').innerHTML = `
                <h1>Welcome to the Audio Library</h1>
                <p>Select an artist and category from the sidebar to browse audio files.</p>
            `;
        }

        function navigateArtist(artist) {
            currentArtist = artist;
            currentCategory = '';
            updateBreadcrumb();
            
            document.getElementById('audioContainer').innerHTML = `
                <h1>${artist}</h1>
                <p>Select a category from the sidebar to browse audio files.</p>
            `;
        }

        // Initialize the library
        document.addEventListener('DOMContentLoaded', () => {
            loadHardcodedStructure();
            
            // Expand first artist by default
            setTimeout(() => {
                const firstArtist = document.querySelector('.category-title');
                if (firstArtist) {
                    firstArtist.click();
                }
            }, 100);
        });
    </script>
</body>
</html>