<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Audio Library</title>
    <style>
        :root {
            --primary-color: #9d46ff;
            --secondary-color: #bb86fc;
            --bg-color: #121212;
            --card-bg: #1e1e1e;
            --text-color: #e0e0e0;
            --sidebar-bg: #2d2d2d;
            --sidebar-hover: #3d3d3d;
            --sidebar-active: #4d2d8a;
            --border-color: #333333;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            min-height: 100vh;
        }

        .sidebar {
            width: 280px;
            background-color: var(--sidebar-bg);
            height: 100vh;
            overflow-y: auto;
            position: fixed;
            top: 0;
            left: 0;
            box-shadow: 2px 0 5px rgba(0,0,0,0.3);
            z-index: 100;
            transition: transform 0.3s ease;
        }

        .sidebar.collapsed {
            transform: translateX(-280px);
        }

        .sidebar-toggle {
            position: fixed;
            top: 10px;
            left: 290px;
            z-index: 101;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 4px;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
            transition: left 0.3s ease;
        }

        .sidebar-toggle.collapsed {
            left: 10px;
        }

        .sidebar-header {
            padding: 20px;
            background-color: var(--primary-color);
            color: white;
            text-align: center;
        }

        .sidebar h2 {
            margin: 0;
            font-size: 1.5rem;
        }

        .sidebar-content {
            padding: 15px;
        }

        .sidebar .category {
            margin-bottom: 15px;
        }

        .sidebar .category-title {
            font-weight: bold;
            cursor: pointer;
            padding: 8px 5px;
            border-radius: 4px;
            transition: background-color 0.2s;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .sidebar .category-title:hover {
            background-color: var(--sidebar-hover);
        }

        .sidebar .category-content {
            margin-left: 15px;
            display: none;
        }

        .sidebar .category-content.active {
            display: block;
        }

        .sidebar .item {
            padding: 8px 5px;
            margin: 5px 0;
            cursor: pointer;
            border-radius: 4px;
            transition: background-color 0.2s;
        }

        .sidebar .item:hover {
            background-color: var(--sidebar-hover);
        }

        .sidebar .item.active {
            background-color: var(--sidebar-active);
        }

        .main-content {
            margin-left: 280px;
            padding: 60px 20px 20px 20px;
            flex-grow: 1;
            transition: margin-left 0.3s ease;
        }

        .main-content.expanded {
            margin-left: 0;
        }

        .audio-card {
            background-color: var(--card-bg);
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
        }

        .audio-title {
            font-size: 1.5rem;
            margin-top: 0;
            margin-bottom: 15px;
            color: var(--secondary-color);
        }

        .audio-description {
            margin-bottom: 20px;
            white-space: pre-line;
            line-height: 1.5;
        }

        audio {
            width: 100%;
            margin-bottom: 10px;
            filter: invert(1);
            border-radius: 30px;
            height: 40px;
        }

        .audio-controls {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 15px;
        }

        .audio-controls button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 4px;
            padding: 8px 15px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .audio-controls button:hover {
            background-color: var(--secondary-color);
        }

        .audio-player-container {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .audio-player-container audio {
            flex-grow: 1;
            margin-bottom: 0;
        }

        .loop-button {
            background-color: var(--card-bg);
            color: var(--text-color);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background-color 0.2s, color 0.2s;
            font-size: 1.1rem;
        }

        .loop-button.active {
            background-color: var(--primary-color);
            color: white;
        }

        h1, h2, h3 {
            color: var(--secondary-color);
        }

        @media (max-width: 768px) {
            .sidebar {
                width: 280px;
                position: fixed;
                transform: translateX(-280px);
            }
            
            .sidebar.collapsed {
                transform: translateX(-280px);
            }
            
            .sidebar.mobile-expanded {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
                width: 100%;
            }
            
            .sidebar-toggle {
                left: 10px;
            }
            
            .sidebar-toggle.mobile-expanded {
                left: 290px;
            }
        }
    </style>
</head>
<body>
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h2>Audio Library</h2>
        </div>
        <div class="sidebar-content" id="artistList">
            <!-- Artists and categories will be populated here -->
        </div>
    </div>
    
    <button id="sidebarToggle" class="sidebar-toggle">â˜°</button>
    
    <div class="main-content" id="mainContent">
        <div id="audioContainer">
            <h1>Welcome to the Audio Library</h1>
            <p>Select an artist and category from the sidebar to browse audio files.</p>
        </div>
    </div>

    <script>
        // Structure to store our data
        const library = {};
        let currentArtist = '';
        let currentCategory = '';
        let currentFile = '';

        // Toggle sidebar
        const sidebar = document.getElementById('sidebar');
        const mainContent = document.getElementById('mainContent');
        const sidebarToggle = document.getElementById('sidebarToggle');
        
        sidebarToggle.addEventListener('click', () => {
            const isMobile = window.innerWidth <= 768;
            
            if (isMobile) {
                sidebar.classList.toggle('mobile-expanded');
                sidebarToggle.classList.toggle('mobile-expanded');
            } else {
                sidebar.classList.toggle('collapsed');
                mainContent.classList.toggle('expanded');
                sidebarToggle.classList.toggle('collapsed');
            }
        });
        
        // Adjust on window resize
        window.addEventListener('resize', () => {
            const isMobile = window.innerWidth <= 768;
            
            if (isMobile) {
                sidebar.classList.remove('collapsed');
                mainContent.classList.remove('expanded');
                sidebarToggle.classList.remove('collapsed');
                
                if (sidebar.classList.contains('mobile-expanded')) {
                    sidebarToggle.classList.add('mobile-expanded');
                } else {
                    sidebarToggle.classList.remove('mobile-expanded');
                }
            } else {
                sidebar.classList.remove('mobile-expanded');
                sidebarToggle.classList.remove('mobile-expanded');
            }
        });

        // Function to scan the directory structure
        async function scanLibrary() {
            try {
                // Fetch list of artists
                const artistsResponse = await fetch('');
                const artistsData = await artistsResponse.json();
                
                // For now, we're hard-coding Penelope as the artist since that's what we see
                const artists = ['Penelope'];
                
                for (const artist of artists) {
                    library[artist] = {};
                    
                    // Fetch categories for each artist
                    const categoriesResponse = await fetch(`${artist}/`);
                    const categoriesData = await categoriesResponse.text();
                    
                    // For Penelope, we know the categories from our directory exploration
                    const categories = ['Original', 'Therapy', 'Dominatrix', 'Teacher', 'Loops', 'Fills'];
                    
                    for (const category of categories) {
                        library[artist][category] = [];
                        
                        // Fetch files in each category
                        const filesResponse = await fetch(`${artist}/${category}/`);
                        const filesHtml = await filesResponse.text();
                        
                        // Since we can't directly list files this way with GitHub Pages,
                        // we'll load them dynamically when a category is selected
                    }
                }
                
                renderSidebar();
            } catch (error) {
                console.error('Error scanning library:', error);
                // If fetch fails, we'll use a more direct approach
                loadHardcodedStructure();
            }
        }

        // Function to load a hardcoded structure since we can't scan directories with client-side JS
        function loadHardcodedStructure() {
            library['Penelope'] = {
                'Original': [],
                'Therapy': [],
                'Dominatrix': [],
                'Teacher': [],
                'Loops': [],
                'Fills': []
            };
            
            renderSidebar();
        }

        // Function to render the sidebar
        function renderSidebar() {
            const artistList = document.getElementById('artistList');
            artistList.innerHTML = '';
            
            for (const artist in library) {
                const artistDiv = document.createElement('div');
                artistDiv.className = 'category';
                
                const artistTitle = document.createElement('div');
                artistTitle.className = 'category-title';
                artistTitle.innerHTML = `
                    <span>${artist}</span>
                    <span>â–¶</span>
                `;
                artistTitle.addEventListener('click', () => {
                    const content = artistDiv.querySelector('.category-content');
                    content.classList.toggle('active');
                    artistTitle.querySelector('span:last-child').textContent = 
                        content.classList.contains('active') ? 'â–¼' : 'â–¶';
                });
                
                const artistContent = document.createElement('div');
                artistContent.className = 'category-content';
                
                for (const category in library[artist]) {
                    const categoryItem = document.createElement('div');
                    categoryItem.className = 'item';
                    categoryItem.textContent = category;
                    categoryItem.addEventListener('click', () => {
                        // Remove active class from all items
                        document.querySelectorAll('.sidebar .item').forEach(item => {
                            item.classList.remove('active');
                        });
                        
                        // Add active class to clicked item
                        categoryItem.classList.add('active');
                        
                        // Load audio files for this category
                        loadCategory(artist, category);
                    });
                    
                    artistContent.appendChild(categoryItem);
                }
                
                artistDiv.appendChild(artistTitle);
                artistDiv.appendChild(artistContent);
                artistList.appendChild(artistDiv);
            }
        }

        // Function to load all audio files in a category
        async function loadCategory(artist, category) {
            currentArtist = artist;
            currentCategory = category;
            
            const audioContainer = document.getElementById('audioContainer');
            audioContainer.innerHTML = `<h1>${artist} - ${category}</h1><div id="audio-list"></div>`;
            const audioList = document.getElementById('audio-list');
            
            try {
                // In a real environment, we would fetch the directory listing
                // Since we can't do that with GitHub Pages, we'll manually load the files
                const fileList = await fetchFilesForCategory(artist, category);
                
                // Group files by base name (without extension)
                const fileGroups = {};
                
                fileList.forEach(file => {
                    const baseName = file.name.substring(0, file.name.lastIndexOf('.'));
                    if (!fileGroups[baseName]) {
                        fileGroups[baseName] = {
                            audio: null,
                            description: null
                        };
                    }
                    
                    if (file.name.endsWith('.mp3')) {
                        fileGroups[baseName].audio = file.path;
                    } else if (file.name.endsWith('.txt')) {
                        fileGroups[baseName].description = file.path;
                    }
                });
                
                // Create a card for each audio file with its description
                for (const baseName in fileGroups) {
                    const group = fileGroups[baseName];
                    
                    if (group.audio && group.description) {
                        // Fetch the description text
                        const descResponse = await fetch(group.description);
                        const descText = await descResponse.text();
                        
                        // Create an audio card
                        const card = document.createElement('div');
                        card.className = 'audio-card';
                        
                        // Create title and description elements
                        const titleElement = document.createElement('h2');
                        titleElement.className = 'audio-title';
                        titleElement.textContent = baseName.replace(/_/g, ' ');
                        
                        const descriptionElement = document.createElement('div');
                        descriptionElement.className = 'audio-description';
                        descriptionElement.textContent = descText;
                        
                        // Create audio player with loop button
                        const audioPlayerContainer = document.createElement('div');
                        audioPlayerContainer.className = 'audio-player-container';
                        
                        const audioElement = document.createElement('audio');
                        audioElement.controls = true;
                        audioElement.src = group.audio;
                        
                        const loopButton = document.createElement('button');
                        loopButton.className = 'loop-button';
                        loopButton.innerHTML = 'ðŸ”';
                        loopButton.title = 'Toggle Loop';
                        loopButton.addEventListener('click', () => {
                            audioElement.loop = !audioElement.loop;
                            loopButton.classList.toggle('active', audioElement.loop);
                        });
                        
                        // Add elements to the card
                        audioPlayerContainer.appendChild(audioElement);
                        audioPlayerContainer.appendChild(loopButton);
                        
                        card.appendChild(titleElement);
                        card.appendChild(descriptionElement);
                        card.appendChild(audioPlayerContainer);
                        
                        audioList.appendChild(card);
                    }
                }
                
                if (audioList.children.length === 0) {
                    audioList.innerHTML = '<p>No audio files found in this category.</p>';
                }
                
            } catch (error) {
                console.error(`Error loading ${artist}/${category}:`, error);
                audioContainer.innerHTML = `
                    <h1>${artist} - ${category}</h1>
                    <p>Error loading audio files. Please try again later.</p>
                `;
            }
        }

        // Function to fetch files for a category
        async function fetchFilesForCategory(artist, category) {
            // In a real environment, we would fetch this from an API
            // For GitHub Pages, we'll use a simulated API call
            
            try {
                const response = await fetch(`https://api.github.com/repos/BebPrompt/BebPrompt.github.io/contents/${artist}/${category}`);
                if (!response.ok) {
                    throw new Error('Failed to fetch directory contents');
                }
                const data = await response.json();
                
                return data.map(item => ({
                    name: item.name,
                    path: item.download_url
                }));
            } catch (error) {
                console.error('Error fetching files:', error);
                return [];
            }
        }

        // Navigation functions
        function navigateHome() {
            currentArtist = '';
            currentCategory = '';
            
            document.getElementById('audioContainer').innerHTML = `
                <h1>Welcome to the Audio Library</h1>
                <p>Select an artist and category from the sidebar to browse audio files.</p>
            `;
        }

        function navigateArtist(artist) {
            currentArtist = artist;
            currentCategory = '';
            
            document.getElementById('audioContainer').innerHTML = `
                <h1>${artist}</h1>
                <p>Select a category from the sidebar to browse audio files.</p>
            `;
        }

        // Initialize the library
        document.addEventListener('DOMContentLoaded', () => {
            loadHardcodedStructure();
            
            // Expand first artist by default
            setTimeout(() => {
                const firstArtist = document.querySelector('.category-title');
                if (firstArtist) {
                    firstArtist.click();
                }
            }, 100);
        });
    </script>
</body>
</html>